ansible-playbook 2.10.8
  config file = /home/bcladmin/_aws/ansible.cfg
  configured module search path = ['/home/bcladmin/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3/dist-packages/ansible
  executable location = /usr/bin/ansible-playbook
  python version = 3.10.12 (main, Feb  4 2025, 14:57:36) [GCC 11.4.0]
Using /home/bcladmin/_aws/ansible.cfg as config file
redirecting (type: callback) ansible.builtin.yaml to community.general.yaml
redirecting (type: callback) ansible.builtin.yaml to community.general.yaml
Skipping callback 'default', as we already have a stdout callback.
Skipping callback 'minimal', as we already have a stdout callback.
Skipping callback 'oneline', as we already have a stdout callback.

PLAYBOOK: delius-artefacts-playbook.yml ****************************************
2 plays in /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml

PLAY [Deploy Delius Artefacts] *************************************************
META: ran handlers

TASK [Deploy Davfs] ************************************************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:11
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False

TASK [Deploy Cfo] **************************************************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:18
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False

TASK [Deploy Users] ************************************************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:22
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False

TASK [Deploy Gdpr] *************************************************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:33
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False

TASK [Deploy Performance Test Users] *******************************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:37
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False

TASK [Deploy MMS User] *********************************************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:44
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False

TASK [Deploy Audited Interaction Compression Job] ******************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:48
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False

TASK [Deploy Audited Interaction Stub Users] ***********************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:58
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False

TASK [Deploy Oracle SQL Plan Management Job] ***********************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:66
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False

TASK [Deploy MV Refresh Purge Child Cursors Job] *******************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:75
skipping: [nd-systest-orc12] => changed=false 
  skip_reason: Conditional result was False
META: ran handlers
META: ran handlers

PLAY [delius_dbs] **************************************************************
META: ran handlers

TASK [Deploy Alfresco Wallet] **************************************************
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/delius-artefacts-playbook.yml:88

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Get Alfresco Host] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:2
ok: [nd-systest-orc12] => changed=false 
  ansible_facts:
    alfresco_host: hmpps-delius-alfresco-dev.apps.live.cloud-platform.service.justice.gov.uk

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : debug] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:7
ok: [nd-systest-orc12] => 
  msg: 'INFO: ALF server host: hmpps-delius-alfresco-dev.apps.live.cloud-platform.service.justice.gov.uk'

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Check that we can connect to the Alfresco server from the host] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:11
ok: [nd-systest-orc12] => changed=false 
  ansible_facts:
    discovered_interpreter_python: /usr/libexec/platform-python
  connection: close
  content_length: '2389'
  content_type: text/html;charset=ISO-8859-1
  cookies:
    JSESSIONID: 65CB41C5A21D80C7DFFCE0DD1A5AB122
    alfrescoRepo: 1744278587.349.402070.817738|d7346793908b9d163d887d5f1729cc97
  cookies_string: alfrescoRepo=1744278587.349.402070.817738|d7346793908b9d163d887d5f1729cc97; JSESSIONID=65CB41C5A21D80C7DFFCE0DD1A5AB122
  date: Thu, 10 Apr 2025 09:49:46 GMT
  elapsed: 0
  msg: OK (2389 bytes)
  redirected: true
  set_cookie: JSESSIONID=65CB41C5A21D80C7DFFCE0DD1A5AB122; Path=/alfresco; Secure; HttpOnly
  status: 200
  strict_transport_security: max-age=31536000; includeSubDomains
  url: https://hmpps-delius-alfresco-dev.apps.live.cloud-platform.service.justice.gov.uk/alfresco/
  x_frame_options: SAMEORIGIN

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : debug] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:17
skipping: [nd-systest-orc12] => 

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Get Oracle Base] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:21
ok: [nd-systest-orc12] => changed=false 
  cmd: |-
    . ~/.bash_profile
    echo $ORACLE_BASE
  delta: '0:00:00.112078'
  end: '2025-04-10 10:49:48.946112'
  rc: 0
  start: '2025-04-10 10:49:48.834034'
  stderr: ''
  stderr_lines: <omitted>
  stdout: |-
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
    /u01/app/oracle
  stdout_lines: <omitted>

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Set Oracle Base] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:28
ok: [nd-systest-orc12] => changed=false 
  ansible_facts:
    oracle_base: |-
      TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
      /u01/app/oracle

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Define Location for Oracle Wallet] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:32
ok: [nd-systest-orc12] => changed=false 
  ansible_facts:
    wallet_dir: |-
      TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
      /u01/app/oracle/wallets/alfresco_wallet

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Create Wallet Directory] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:36
changed: [nd-systest-orc12] => changed=true 
  gid: 54321
  group: oinstall
  mode: '0755'
  owner: oracle
  path: |-
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
    /u01/app/oracle/wallets/alfresco_wallet
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 6
  state: directory
  uid: 54321

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Get Alfresco URL Currently Configured] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:48
ok: [nd-systest-orc12] => changed=false 
  rc: 0
  stderr: |-
    Shared connection to nd-systest-orc12 closed.
  stderr_lines: <omitted>
  stdout: |-
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
    https://hmpps-delius-alfresco-dev.apps.live.cloud-platform.service.justice.gov.uk/alfresco/service/noms-spg
  stdout_lines: <omitted>

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Set Alfresco URL Specific for this environment] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:53
changed: [nd-systest-orc12] => changed=true 
  rc: 0
  stderr: |-
    Shared connection to nd-systest-orc12 closed.
  stderr_lines: <omitted>
  stdout: |-
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
  stdout_lines: <omitted>

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Create Access Control Entry for the Alfresco Host] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:59
changed: [nd-systest-orc12] => changed=true 
  rc: 0
  stderr: |-
    Shared connection to nd-systest-orc12 closed.
  stderr_lines: <omitted>
  stdout: |-
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
  stdout_lines: <omitted>

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Get Previous Alfresco Host] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:64
ok: [nd-systest-orc12] => changed=false 
  ansible_facts:
    prev_alfresco_host: TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Remove Access Control Entries for the Previous Alfresco Host] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:68
changed: [nd-systest-orc12] => changed=true 
  rc: 0
  stderr: |-
    Shared connection to nd-systest-orc12 closed.
  stderr_lines: <omitted>
  stdout: |-
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
  stdout_lines: <omitted>

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Get Alfresco Wallet Location currently in SPG_CONTROL] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:76
ok: [nd-systest-orc12] => changed=false 
  rc: 0
  stderr: |-
    Shared connection to nd-systest-orc12 closed.
  stderr_lines: <omitted>
  stdout: |-
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
    /u01/app/oracle/wallets/alfresco_wallet
  stdout_lines: <omitted>

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : debug] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:81
ok: [nd-systest-orc12] => 
  msg: |-
    Changing Wallet Location from TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
    /u01/app/oracle/wallets/alfresco_wallet
  
     to TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
    /u01/app/oracle/wallets/alfresco_wallet

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Set Alfresco Wallet Location to Intended Value] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:85
changed: [nd-systest-orc12] => changed=true 
  rc: 0
  stderr: |-
    Shared connection to nd-systest-orc12 closed.
  stderr_lines: <omitted>
  stdout: |-
    TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
  stdout_lines: <omitted>

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Fetch Alfresco SSL Certificates] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:100
ok: [nd-systest-orc12] => changed=false 
  cmd: |-
    echo Q | openssl s_client -connect hmpps-delius-alfresco-dev.apps.live.cloud-platform.service.justice.gov.uk:443 -tls1_2 -showcerts > /tmp/alf_certs.txt
  delta: '0:00:00.125434'
  end: '2025-04-10 10:50:05.534546'
  rc: 0
  start: '2025-04-10 10:50:05.409112'
  stderr: |-
    depth=2 C = US, O = Internet Security Research Group, CN = ISRG Root X1
    verify return:1
    depth=1 C = US, O = Let's Encrypt, CN = R11
    verify return:1
    depth=0 CN = *.apps.live.cloud-platform.service.justice.gov.uk
    verify return:1
    DONE
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Get List of Any Pre-Existing Individual Certificate Files] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:108
ok: [nd-systest-orc12] => changed=false 
  examined: 11
  files:
  - atime: 1744278502.106921
    ctime: 1744278502.109921
    dev: 64768
    gid: 54321
    gr_name: oinstall
    inode: 135402891
    isblk: false
    ischr: false
    isdir: false
    isfifo: false
    isgid: false
    islnk: false
    isreg: true
    issock: false
    isuid: false
    mode: '0644'
    mtime: 1744278502.109921
    nlink: 1
    path: /tmp/alf.00.crt
    pw_name: oracle
    rgrp: true
    roth: true
    rusr: true
    size: 2183
    uid: 54321
    wgrp: false
    woth: false
    wusr: true
    xgrp: false
    xoth: false
    xusr: false
  - atime: 1744278502.109921
    ctime: 1744278502.110921
    dev: 64768
    gid: 54321
    gr_name: oinstall
    inode: 135402892
    isblk: false
    ischr: false
    isdir: false
    isfifo: false
    isgid: false
    islnk: false
    isreg: true
    issock: false
    isuid: false
    mode: '0644'
    mtime: 1744278502.110921
    nlink: 1
    path: /tmp/alf.01.crt
    pw_name: oracle
    rgrp: true
    roth: true
    rusr: true
    size: 1801
    uid: 54321
    wgrp: false
    woth: false
    wusr: true
    xgrp: false
    xoth: false
    xusr: false
  matched: 2
  msg: ''

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Remove Any Pre-Existing Individual Certificate Files] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:114
changed: [nd-systest-orc12] => (item={'path': '/tmp/alf.00.crt', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 54321, 'gid': 54321, 'size': 2183, 'inode': 135402891, 'dev': 64768, 'nlink': 1, 'atime': 1744278502.106921, 'mtime': 1744278502.109921, 'ctime': 1744278502.109921, 'gr_name': 'oinstall', 'pw_name': 'oracle', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False}) => changed=true 
  ansible_loop_var: item
  item:
    atime: 1744278502.106921
    ctime: 1744278502.109921
    dev: 64768
    gid: 54321
    gr_name: oinstall
    inode: 135402891
    isblk: false
    ischr: false
    isdir: false
    isfifo: false
    isgid: false
    islnk: false
    isreg: true
    issock: false
    isuid: false
    mode: '0644'
    mtime: 1744278502.109921
    nlink: 1
    path: /tmp/alf.00.crt
    pw_name: oracle
    rgrp: true
    roth: true
    rusr: true
    size: 2183
    uid: 54321
    wgrp: false
    woth: false
    wusr: true
    xgrp: false
    xoth: false
    xusr: false
  path: /tmp/alf.00.crt
  state: absent
changed: [nd-systest-orc12] => (item={'path': '/tmp/alf.01.crt', 'mode': '0644', 'isdir': False, 'ischr': False, 'isblk': False, 'isreg': True, 'isfifo': False, 'islnk': False, 'issock': False, 'uid': 54321, 'gid': 54321, 'size': 1801, 'inode': 135402892, 'dev': 64768, 'nlink': 1, 'atime': 1744278502.109921, 'mtime': 1744278502.110921, 'ctime': 1744278502.110921, 'gr_name': 'oinstall', 'pw_name': 'oracle', 'wusr': True, 'rusr': True, 'xusr': False, 'wgrp': False, 'rgrp': True, 'xgrp': False, 'woth': False, 'roth': True, 'xoth': False, 'isuid': False, 'isgid': False}) => changed=true 
  ansible_loop_var: item
  item:
    atime: 1744278502.109921
    ctime: 1744278502.110921
    dev: 64768
    gid: 54321
    gr_name: oinstall
    inode: 135402892
    isblk: false
    ischr: false
    isdir: false
    isfifo: false
    isgid: false
    islnk: false
    isreg: true
    issock: false
    isuid: false
    mode: '0644'
    mtime: 1744278502.110921
    nlink: 1
    path: /tmp/alf.01.crt
    pw_name: oracle
    rgrp: true
    roth: true
    rusr: true
    size: 1801
    uid: 54321
    wgrp: false
    woth: false
    wusr: true
    xgrp: false
    xoth: false
    xusr: false
  path: /tmp/alf.01.crt
  state: absent

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Split Certificate Output into Individual Certificate Files] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:125
ok: [nd-systest-orc12] => changed=false 
  cmd: |-
    awk 'BEGIN{INFLAG=0}
    /-----BEGIN CERTIFICATE-----/{INFLAG=1}
    {if(INFLAG==1){print $0}}
    /-----END CERTIFICATE-----/{INFLAG=0}' /tmp/alf_certs.txt | csplit --prefix='/tmp/alf.' --suffix-format='%02d.crt' --elide-empty-files  - "/-----END CERTIFICATE-----/+1" {*}
  delta: '0:00:00.026249'
  end: '2025-04-10 10:50:14.760301'
  rc: 0
  start: '2025-04-10 10:50:14.734052'
  stderr: ''
  stderr_lines: <omitted>
  stdout: |-
    2183
    1801
  stdout_lines: <omitted>

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Define Working Directory for Recreating Oracle Wallet] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:133
ok: [nd-systest-orc12] => changed=false 
  ansible_facts:
    wallet_working_dir: |-
      TMP=/u01/tmp TEMP=/u01/tmp TMPDIR=/u01/tmp
      /u01/app/oracle/wallets/alfresco_wallet_work

TASK [/home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet : Get system password from Secrets Manager] ***
task path: /home/bcladmin/_aws/hmpps-delius-operational-automation/playbooks/alfresco_wallet/alfresco_wallet/tasks/main.yml:138
fatal: [nd-systest-orc12]: FAILED! => changed=false 
  censored: 'the output has been hidden due to the fact that ''no_log: true'' was specified for this result'

PLAY RECAP *********************************************************************
nd-systest-orc12           : ok=20   changed=6    unreachable=0    failed=1    skipped=11   rescued=0    ignored=0   

